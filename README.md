# Тема: Валідація, обробка помилок, ORM
# Дисципліна: Технології розроблення серверного ПЗ (Back-end)
# Варіант: 35 % 3 = 2 → Користувацькі категорії витрат

## Мета роботи

Реалізувати бекенд-застосунок, який включає:

- валідацію вхідних даних і коректну обробку помилок;
- роботу з ORM Flask-SQLAlchemy та міграціями Flask-Migrate;
- зберігання даних у PostgreSQL;
- побудову REST-API з документацією (Flask-Smorest, Swagger /docs);
- підготовку сервісу до розгортання на Render.com.

## Використані технології

Python 3.11 · Flask · Flask-SQLAlchemy · Flask-Migrate · Marshmallow · Flask-Smorest · PostgreSQL · Gunicorn

---

## Варіант 2 — Користувацькі категорії витрат

У межах варіанту реалізовано розширену логіку роботи з категоріями витрат:

- **Загальні категорії**  
  `is_global = true` — доступні всім користувачам.

- **Користувацькі категорії**  
  прив’язані до конкретного користувача (`user_id`), доступні тільки власнику.

- **При створенні витратного запису виконується перевірка:**
  - чи існує категорія;
  - чи має користувач право використовувати цю категорію (не можна використовувати чужу персональну категорію);
  - чи коректні дані згідно зі схемами Marshmallow.

---

## Локальний запуск

```bash
python -m venv venv
venv\Scripts\activate        # або source venv/bin/activate на Linux/macOS
pip install -r requirements.txt

set FLASK_APP=app.py
set DATABASE_URL=postgresql://postgres:1234@localhost:5432/lab3_db

flask db init
flask db migrate -m "Initial migration"
flask db upgrade

python app.py
```

---

## Доступ до API

Сервер запускається за адресою:  
http://localhost:5000

Документація Swagger:  
http://localhost:5000/docs

---

## Основні ендпоінти

| Метод | Шлях        | Опис |
|-------|-------------|-------|
| GET   | `/user`     | Отримати список користувачів |
| POST  | `/user`     | Створити нового користувача |
| GET   | `/category` | Отримати глобальні та персональні категорії |
| POST  | `/category` | Створити категорію витрат |
| GET   | `/record`   | Переглянути записи витрат |
| POST  | `/record`   | Додати витратний запис |
